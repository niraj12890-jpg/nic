<!DOCTYPE html>
<html lang="hi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>‡§®‡•á‡§π‡§∞‡•Ç ‡§á‡§£‡•ç‡§ü‡§∞ ‡§ï‡§æ‡§≤‡•á‡§ú - Official Portal</title>
  
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
  
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Mukta:wght@300;400;700;800&display=swap');
    body { font-family: 'Mukta', sans-serif; scroll-behavior: smooth; background-color: #f3f4f6; }
    
    .hero-bg {
      background: linear-gradient(rgba(30, 58, 138, 0.85), rgba(30, 58, 138, 0.75)), 
                  url('https://images.unsplash.com/photo-1541339907198-e08756ebafe3?auto=format&fit=crop&q=80&w=1200');
      background-size: cover; background-position: center;
    }

    .glass-card {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
    }

    @media print {
      .no-print { display: none !important; }
      #printableArea { visibility: visible; position: absolute; left: 0; top: 0; width: 100%; }
      body { background: white; }
    }

    /* Custom Scrollbar */
    ::-webkit-scrollbar { width: 8px; }
    ::-webkit-scrollbar-track { background: #f1f1f1; }
    ::-webkit-scrollbar-thumb { background: #1e3a8a; border-radius: 10px; }
  </style>
</head>
<body>

  <div class="bg-yellow-400 text-blue-900 py-1.5 font-bold shadow-sm no-print">
    <marquee behavior="scroll" direction="left">
      üì¢ ‡§®‡•á‡§π‡§∞‡•Ç ‡§á‡§£‡•ç‡§ü‡§∞ ‡§ï‡§æ‡§≤‡•á‡§ú, ‡§ú‡§Ç‡§ó‡§≤ ‡§®‡§æ‡§π‡§∞ ‡§õ‡§™‡§∞‡§æ ‡§Æ‡•á‡§Ç ‡§Ü‡§™‡§ï‡§æ ‡§∏‡•ç‡§µ‡§æ‡§ó‡§§ ‡§π‡•à | ‡§∏‡§§‡•ç‡§∞ 2025-26 ‡§ï‡•á ‡§≤‡§ø‡§è ‡§®‡§µ‡•Ä‡§® ‡§™‡•ç‡§∞‡§µ‡•á‡§∂ ‡§™‡•ç‡§∞‡§æ‡§∞‡§Æ‡•ç‡§≠ | ‡§°‡§ø‡§ú‡§ø‡§ü‡§≤ ‡§™‡•ã‡§∞‡•ç‡§ü‡§≤ ‡§∏‡•á ‡§Ö‡§™‡§®‡§æ ‡§Ü‡§à‡§°‡•Ä ‡§ï‡§æ‡§∞‡•ç‡§° ‡§î‡§∞ ‡§´‡•Ä‡§∏ ‡§µ‡§ø‡§µ‡§∞‡§£ ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡•á‡§Ç‡•§
    </marquee>
  </div>

  <nav class="bg-blue-900 text-white shadow-2xl sticky top-0 z-50 no-print">
    <div class="container mx-auto px-4 py-3 flex justify-between items-center">
      <div class="flex items-center space-x-3 cursor-pointer" onclick="showPage('home')">
        <div class="bg-white text-blue-900 h-10 w-10 flex items-center justify-center rounded-full font-black shadow-lg">NIC</div>
        <div>
          <h1 class="text-xl font-bold leading-none">‡§®‡•á‡§π‡§∞‡•Ç ‡§á‡§£‡•ç‡§ü‡§∞ ‡§ï‡§æ‡§≤‡•á‡§ú</h1>
          <p class="text-[10px] text-blue-200 tracking-widest">ESTD: 19XX</p>
        </div>
      </div>
      <div class="flex items-center space-x-3">
        <button onclick="showPage('portal')" class="bg-yellow-500 hover:bg-yellow-400 text-blue-900 px-5 py-1.5 rounded-xl font-bold transition-all shadow-md transform hover:scale-105">Student Zone</button>
        <button onclick="adminLogin()" class="bg-blue-800 text-blue-200 p-2 rounded-lg hover:text-white transition shadow-inner"><i class="fas fa-user-shield"></i></button>
      </div>
    </div>
  </nav>

  <div id="home" class="page-section animate__animated animate__fadeIn">
    <div class="hero-bg min-h-[600px] flex items-center justify-center text-center text-white px-4">
      <div class="max-w-4xl">
        <span class="bg-blue-600/50 px-4 py-1 rounded-full text-sm font-bold mb-4 inline-block border border-blue-400">JUNGLE NAHAR CHHAPRA, DEORIA</span>
        <h2 class="text-5xl md:text-8xl font-black mb-6 drop-shadow-2xl">‡§∂‡§ø‡§ï‡•ç‡§∑‡§æ ‡§π‡•Ä ‡§∂‡§ï‡•ç‡§§‡§ø ‡§π‡•à</h2>
        <p class="text-xl md:text-2xl mb-12 text-blue-100 font-light italic">"Knowledge is power. Information is liberating. Education is the premise of progress."</p>
        <div class="flex flex-col md:flex-row justify-center gap-6">
          <button onclick="showPage('admission')" class="bg-red-600 hover:bg-red-700 px-12 py-5 rounded-2xl font-bold text-xl shadow-2xl transition-all transform hover:-translate-y-1 border-b-4 border-red-800">‡§®‡§Ø‡§æ ‡§™‡•ç‡§∞‡§µ‡•á‡§∂ ‡§´‡§æ‡§∞‡•ç‡§Æ</button>
          <button onclick="showPage('portal')" class="bg-white text-blue-900 hover:bg-gray-100 px-12 py-5 rounded-2xl font-bold text-xl shadow-2xl transition-all transform hover:-translate-y-1">‡§°‡§ø‡§ú‡§ø‡§ü‡§≤ ‡§™‡•ã‡§∞‡•ç‡§ü‡§≤</button>
        </div>
      </div>
    </div>
  </div>

  <div id="portal" class="hidden container mx-auto p-6 page-section animate__animated animate__zoomIn">
    <div class="text-center mb-10 no-print">
      <h2 class="text-3xl font-black text-blue-900 uppercase">‡§µ‡§ø‡§¶‡•ç‡§Ø‡§æ‡§∞‡•ç‡§•‡•Ä ‡§™‡•ã‡§∞‡•ç‡§ü‡§≤ (Digital Services)</h2>
      <p class="text-gray-500">‡§Ö‡§™‡§®‡§æ ‡§µ‡§ø‡§µ‡§∞‡§£ ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§®‡•Ä‡§ö‡•á ‡§¶‡§ø‡§è ‡§ó‡§è ‡§µ‡§ø‡§ï‡§≤‡•ç‡§™‡•ã‡§Ç ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡•á‡§Ç</p>
    </div>

    <div class="grid md:grid-cols-3 gap-8 mb-12 no-print">
      <div class="glass-card p-8 rounded-[2rem] shadow-xl border-t-8 border-green-500 text-center transform transition hover:scale-105">
        <div class="bg-green-100 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4 text-green-600 text-2xl"><i class="fas fa-file-signature"></i></div>
        <h3 class="font-bold text-xl mb-4 text-blue-900">‡§™‡§∞‡•Ä‡§ï‡•ç‡§∑‡§æ ‡§™‡§∞‡§ø‡§£‡§æ‡§Æ</h3>
        <input id="rollRes" class="w-full border-2 border-gray-200 p-3 rounded-xl mb-4 focus:border-green-500 outline-none transition" placeholder="Roll Number">
        <button onclick="fetchData('Result')" class="w-full bg-green-600 hover:bg-green-700 text-white py-3 rounded-xl font-bold shadow-lg">‡§∞‡§ø‡§ú‡§≤‡•ç‡§ü ‡§¶‡•á‡§ñ‡•á‡§Ç</button>
      </div>

      <div class="glass-card p-8 rounded-[2rem] shadow-xl border-t-8 border-blue-500 text-center transform transition hover:scale-105">
        <div class="bg-blue-100 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4 text-blue-600 text-2xl"><i class="fas fa-id-card"></i></div>
        <h3 class="font-bold text-xl mb-4 text-blue-900">ID & Fees Status</h3>
        <input id="idInput" class="w-full border-2 border-gray-200 p-3 rounded-xl mb-4 focus:border-blue-500 outline-none transition" placeholder="Student ID (NIC-...)">
        <button onclick="fetchData('ID')" class="w-full bg-blue-600 hover:bg-blue-700 text-white py-3 rounded-xl font-bold shadow-lg">‡§ï‡§æ‡§∞‡•ç‡§° / ‡§´‡•Ä‡§∏ ‡§¶‡•á‡§ñ‡•á‡§Ç</button>
      </div>

      <div class="glass-card p-8 rounded-[2rem] shadow-xl border-t-8 border-orange-500 text-center transform transition hover:scale-105">
        <div class="bg-orange-100 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4 text-orange-600 text-2xl"><i class="fas fa-ticket-alt"></i></div>
        <h3 class="font-bold text-xl mb-4 text-blue-900">‡§™‡•ç‡§∞‡§µ‡•á‡§∂ ‡§™‡§§‡•ç‡§∞</h3>
        <input id="admitInput" class="w-full border-2 border-gray-200 p-3 rounded-xl mb-4 focus:border-orange-500 outline-none transition" placeholder="Roll Number">
        <button onclick="fetchData('Admit')" class="w-full bg-orange-500 hover:bg-orange-600 text-white py-3 rounded-xl font-bold shadow-lg">‡§°‡§æ‡§â‡§®‡§≤‡•ã‡§° ‡§ï‡§∞‡•á‡§Ç</button>
      </div>
    </div>

    <div id="printableArea" class="flex justify-center pb-20 min-h-[300px]"></div>
  </div>

  <div id="admission" class="hidden container mx-auto max-w-2xl p-6 page-section">
    <div class="bg-white p-10 rounded-[2.5rem] shadow-2xl border-t-8 border-blue-900 animate__animated animate__fadeInUp">
      <div class="text-center mb-8">
        <h2 class="text-3xl font-black text-blue-900 uppercase">‡§™‡•ç‡§∞‡§µ‡•á‡§∂ ‡§Ü‡§µ‡•á‡§¶‡§® 2025-26</h2>
        <p class="text-gray-400">‡§ï‡•É‡§™‡§Ø‡§æ ‡§∏‡§≠‡•Ä ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ‡§∏‡§π‡•Ä-‡§∏‡§π‡•Ä ‡§≠‡§∞‡•á‡§Ç</p>
      </div>
      <form id="admissionForm" class="space-y-5">
        <div class="grid md:grid-cols-2 gap-4">
          <input name="name" required placeholder="Student Name" class="w-full border-2 p-4 rounded-2xl focus:border-blue-500 outline-none">
          <input name="fname" required placeholder="Father's Name" class="w-full border-2 p-4 rounded-2xl focus:border-blue-500 outline-none">
        </div>
        <input name="mobile" required placeholder="Mobile Number" class="w-full border-2 p-4 rounded-2xl focus:border-blue-500 outline-none">
        <div class="grid md:grid-cols-2 gap-4">
          <select name="class" class="w-full border-2 p-4 rounded-2xl focus:border-blue-500 outline-none">
            <option>Class 9th</option><option>Class 10th</option><option>Class 11th</option><option>Class 12th</option>
          </select>
          <select name="stream" class="w-full border-2 p-4 rounded-2xl focus:border-blue-500 outline-none">
            <option>Science</option><option>Arts</option><option>Commerce</option>
          </select>
        </div>
        <button type="submit" id="subBtn" class="w-full bg-blue-900 hover:bg-blue-800 text-white py-5 rounded-2xl font-bold text-xl shadow-xl transition-all border-b-4 border-black">‡§Ü‡§µ‡•á‡§¶‡§® ‡§ú‡§Æ‡§æ ‡§ï‡§∞‡•á‡§Ç</button>
      </form>
    </div>
  </div>

  <div id="adminPanel" class="hidden container mx-auto p-6 page-section animate__animated animate__fadeIn">
    <div class="bg-white p-8 rounded-[2rem] shadow-2xl border-t-8 border-red-600">
      <div class="flex flex-col md:flex-row justify-between items-center mb-8 gap-4">
        <h2 class="text-3xl font-black text-gray-800 uppercase italic">Admin: <span class="text-red-600 underline">Fees Manager</span></h2>
        <div class="flex gap-2">
            <button onclick="loadAdminData('all')" class="bg-gray-100 text-gray-700 px-4 py-2 rounded-xl font-bold hover:bg-gray-200">All List</button>
            <button onclick="loadAdminData('defaulters')" class="bg-red-100 text-red-600 px-4 py-2 rounded-xl font-bold hover:bg-red-200 border border-red-200 italic">!! Defaulter List (‡§¨‡§æ‡§ï‡•Ä) !!</button>
            <button onclick="showPage('home')" class="bg-black text-white px-4 py-2 rounded-xl font-bold">Exit</button>
        </div>
      </div>
      
      <div id="adminData" class="overflow-x-auto rounded-xl border border-gray-100">
         </div>
    </div>
  </div>

  <div id="successModal" class="hidden fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center p-4 z-[100]">
    <div class="bg-white p-10 rounded-[3rem] text-center max-w-sm w-full shadow-2xl transform animate__animated animate__bounceIn">
      <div class="text-6xl text-green-500 mb-6"><i class="fas fa-check-circle"></i></div>
      <h3 class="text-2xl font-black text-blue-900 mb-2">‡§∏‡§´‡§≤‡§§‡§æ‡§™‡•Ç‡§∞‡•ç‡§µ‡§ï ‡§ú‡§Æ‡§æ!</h3>
      <p id="msgText" class="font-bold text-gray-600 mb-8"></p>
      <button onclick="location.reload()" class="bg-blue-900 text-white w-full py-4 rounded-2xl font-bold shadow-lg hover:bg-blue-800 transition">‡§µ‡§æ‡§™‡§∏ ‡§ú‡§æ‡§è‡§Å</button>
    </div>
  </div>

  <script>
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxcE6dfDaF2uUCxeU3Li6_anu-v1RbrQFxNF2OyMp5D87_3GGc70Ygfd6swZJtaqanl0Q/exec";

    function showPage(pageId) {
      document.querySelectorAll('.page-section').forEach(p => p.classList.add('hidden'));
      document.getElementById(pageId).classList.remove('hidden');
      window.scrollTo(0,0);
    }

    // Fetch Data from Server
    async function fetchData(type) {
      const area = document.getElementById('printableArea');
      let fieldId = (type === 'Result') ? 'rollRes' : (type === 'ID' ? 'idInput' : 'admitInput');
      const val = document.getElementById(fieldId).value;
      
      if(!val) { alert("‡§ï‡•É‡§™‡§Ø‡§æ ID ‡§Ø‡§æ ‡§∞‡•ã‡§≤ ‡§®‡§Ç‡§¨‡§∞ ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç!"); return; }
      
      area.innerHTML = `
        <div class="text-center py-10">
            <div class="animate-spin text-4xl text-blue-900 mb-2"><i class="fas fa-circle-notch"></i></div>
            <p class="font-bold text-blue-900 italic">‡§°‡•á‡§ü‡§æ ‡§ñ‡•ã‡§ú ‡§∞‡§π‡•á ‡§π‡•à‡§Ç, ‡§ï‡•É‡§™‡§Ø‡§æ ‡§™‡•ç‡§∞‡§§‡•Ä‡§ï‡•ç‡§∑‡§æ ‡§ï‡§∞‡•á‡§Ç...</p>
        </div>`;
      
      try {
        const resp = await fetch(SCRIPT_URL, {method:'POST', body: JSON.stringify({action:"getStudent", id:val, type:type})});
        const data = await resp.json();
        
        if(!data) { area.innerHTML = "<p class='text-red-600 font-black p-10 bg-red-50 rounded-2xl border-2 border-red-200 mt-10 animate__animated animate__headShake'>‚ùå ‡§∞‡§ø‡§ï‡•â‡§∞‡•ç‡§° ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡§æ! ‡§ï‡•É‡§™‡§Ø‡§æ ‡§∏‡§π‡•Ä ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ‡§≠‡§∞‡•á‡§Ç‡•§</p>"; return; }
        
        renderCard(data, type);
      } catch (e) {
        area.innerHTML = "<p class='text-red-500'>Error connecting to server!</p>";
      }
    }

    // Render HTML Cards
    function renderCard(data, type) {
      const area = document.getElementById('printableArea');
      let html = "";

      if(type === 'ID') {
        html = `
        <div class="bg-white border-[6px] border-blue-900 w-80 rounded-[2.5rem] shadow-2xl overflow-hidden animate__animated animate__fadeInUp">
            <div class="bg-blue-900 text-white p-5 text-center shadow-lg">
                <h4 class="font-black uppercase tracking-tighter">Nehru Inter College</h4>
                <p class="text-[8px] opacity-75">Jungle Nahar Chhapra, Deoria (U.P.)</p>
            </div>
            <div class="p-6 text-center relative">
                <div class="w-28 h-28 border-4 border-blue-900 mx-auto mb-4 overflow-hidden rounded-full shadow-inner shadow-black/20">
                    <img src="${data.PhotoURL || 'https://via.placeholder.com/150'}" class="w-full h-full object-cover">
                </div>
                <h3 class="text-2xl font-black text-blue-900 uppercase leading-tight">${data.Name}</h3>
                <p class="text-xs font-bold text-red-600 mb-6 border-b-2 border-red-100 pb-1 inline-block">ID CARD: 2025-26</p>
                
                <div class="text-left text-sm space-y-2 font-bold bg-blue-50 p-4 rounded-2xl mb-4 border border-blue-100">
                    <p class="flex justify-between"><span>S/O:</span> <span class="text-blue-900">${data.FatherName}</span></p>
                    <p class="flex justify-between"><span>CLASS:</span> <span class="text-blue-900">${data.Class}</span></p>
                    <p class="flex justify-between"><span>ROLL NO:</span> <span class="text-blue-900">${data.RollNo || data.StudentID}</span></p>
                </div>

                <div class="bg-gray-100 p-3 rounded-2xl border-2 border-dashed border-gray-300 text-left">
                    <h5 class="text-[10px] font-black text-gray-400 mb-1 uppercase tracking-widest text-center italic border-b mb-2">Digital Fees Ledger</h5>
                    <p class="flex justify-between text-xs font-black"><span>PAID FEES:</span> <span class="text-green-600">‚Çπ${data.PaidFees || 0}</span></p>
                    <p class="flex justify-between text-xs font-black"><span>BALANCE:</span> <span class="text-red-600">‚Çπ${data.Balance || 5000}</span></p>
                </div>
            </div>
            <div class="flex">
                <button onclick="window.print()" class="no-print bg-blue-900 text-white w-full py-4 font-black hover:bg-black transition uppercase">Download Card</button>
            </div>
        </div>`;
      } else if(type === 'Result') {
        html = `
        <div class="bg-white p-8 border-[12px] border-double border-blue-900 max-w-2xl w-full shadow-2xl animate__animated animate__fadeIn">
            <h2 class="text-3xl font-black text-blue-900 text-center uppercase leading-none">‡§®‡•á‡§π‡§∞‡•Ç ‡§á‡§£‡•ç‡§ü‡§∞ ‡§ï‡§æ‡§≤‡•á‡§ú</h2>
            <p class="text-center text-sm font-bold text-gray-500 mb-4 tracking-widest uppercase">‡§ú‡§Ç‡§ó‡§≤ ‡§®‡§æ‡§π‡§∞ ‡§õ‡§™‡§∞‡§æ, ‡§¶‡•á‡§µ‡§∞‡§ø‡§Ø‡§æ</p>
            <div class="bg-red-600 text-white text-center py-1 font-bold mb-6 text-xl">‡§µ‡§æ‡§∞‡•ç‡§∑‡§ø‡§ï ‡§™‡§∞‡•Ä‡§ï‡•ç‡§∑‡§æ ‡§™‡§∞‡§ø‡§£‡§æ‡§Æ - 2025</div>
            
            <div class="grid grid-cols-2 gap-4 mb-6 font-bold uppercase text-sm border-b-2 border-gray-100 pb-4">
                <p>‡§®‡§æ‡§Æ: <span class="text-blue-900">${data.Name}</span></p>
                <p class="text-right">‡§∞‡•ã‡§≤ ‡§®‡§Ç: <span class="text-blue-900">${data.RollNo}</span></p>
                <p>‡§™‡§ø‡§§‡§æ: <span class="text-blue-900">${data.FatherName}</span></p>
                <p class="text-right">‡§ï‡§ï‡•ç‡§∑‡§æ: <span class="text-blue-900">${data.Class}</span></p>
            </div>

            <table class="w-full border-2 border-blue-900 text-center font-bold">
                <tr class="bg-blue-900 text-white">
                    <th class="p-2 border">‡§µ‡§ø‡§∑‡§Ø (Subject)</th>
                    <th class="p-2 border">‡§™‡•Ç‡§∞‡•ç‡§£‡§æ‡§Ç‡§ï</th>
                    <th class="p-2 border">‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§‡§æ‡§Ç‡§ï</th>
                </tr>
                <tr><td class="p-2 border text-left">HINDI</td><td class="p-2 border">100</td><td class="p-2 border">${data.Hindi}</td></tr>
                <tr><td class="p-2 border text-left">ENGLISH</td><td class="p-2 border">100</td><td class="p-2 border">${data.English}</td></tr>
                <tr><td class="p-2 border text-left">MATHS</td><td class="p-2 border">100</td><td class="p-2 border">${data.Maths}</td></tr>
                <tr><td class="p-2 border text-left">SCIENCE</td><td class="p-2 border">100</td><td class="p-2 border">${data.Science}</td></tr>
                <tr class="bg-blue-50 text-xl"><td class="p-2 border text-left">TOTAL</td><td class="p-2 border">400</td><td class="p-2 border text-blue-900 font-black">${data.Total}</td></tr>
            </table>

            <div class="mt-8 flex justify-between items-center">
                <div class="text-3xl font-black italic text-green-700 underline">${data.Status}</div>
                <div class="text-center border-t border-black px-6 pt-1 font-bold text-xs uppercase">‡§™‡•ç‡§∞‡§ß‡§æ‡§®‡§æ‡§ö‡§æ‡§∞‡•ç‡§Ø ‡§ï‡•á ‡§π‡§∏‡•ç‡§§‡§æ‡§ï‡•ç‡§∑‡§∞</div>
            </div>
            <button onclick="window.print()" class="no-print mt-10 w-full bg-black text-white py-3 rounded-xl font-bold uppercase">Print Marksheet</button>
        </div>`;
      }
      area.innerHTML = html;
    }

    // Admission Form Submit
    document.getElementById('admissionForm').onsubmit = async (e) => {
      e.preventDefault();
      const btn = document.getElementById('subBtn');
      btn.disabled = true; btn.innerHTML = "<i class='fas fa-spinner animate-spin'></i> Processing...";
      
      const formData = {
        name: e.target.name.value,
        fname: e.target.fname.value,
        mobile: e.target.mobile.value,
        class: e.target.class.value
      };

      try {
        const resp = await fetch(SCRIPT_URL, {method:'POST', body: JSON.stringify({action:"submitAdmission", formData: formData})});
        const res = await resp.json();
        if(res.success) {
          document.getElementById('msgText').innerHTML = `‡§Ü‡§™‡§ï‡§æ ‡§Ü‡§µ‡•á‡§¶‡§® ‡§∏‡•ç‡§µ‡•Ä‡§ï‡§æ‡§∞ ‡§ï‡§∞ ‡§≤‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•à‡•§ <br> <span class='text-blue-900 text-2xl font-black'>STUDENT ID: ${res.id}</span> <br> <span class='text-[10px] text-red-500 italic font-bold'>*‡§ï‡•É‡§™‡§Ø‡§æ ‡§á‡§∏‡•á ‡§®‡•ã‡§ü ‡§ï‡§∞ ‡§≤‡•á‡§Ç</span>`;
          document.getElementById('successModal').classList.remove('hidden');
        }
      } catch(err) {
        alert("Server connection error!");
        btn.disabled = false; btn.innerHTML = "‡§Ü‡§µ‡•á‡§¶‡§® ‡§ú‡§Æ‡§æ ‡§ï‡§∞‡•á‡§Ç";
      }
    };

    // ADMIN FEATURES
    function adminLogin() {
      let p = prompt("Admin Security Key ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç:");
      if(p === "NIC123") {
        showPage('adminPanel');
        loadAdminData('all');
      } else {
        alert("Security Key ‡§ó‡§≤‡§§ ‡§π‡•à!");
      }
    }

    async function loadAdminData(filter = 'all') {
      const area = document.getElementById('adminData');
      area.innerHTML = "<div class='p-20 text-center animate-pulse font-black text-gray-400 italic'>Loading Secure Database...</div>";
      
      const resp = await fetch(SCRIPT_URL, {method:'POST', body: JSON.stringify({action:"getAllFees"})});
      let data = await resp.json();
      
      if(filter === 'defaulters') {
        data = data.filter(s => Number(s.Balance) > 0);
      }

      let html = `
        <table class="w-full text-left bg-white">
          <thead class="bg-gray-800 text-white text-xs uppercase italic">
            <tr>
              <th class="p-4 border">Student ID</th>
              <th class="p-4 border">Name / Class</th>
              <th class="p-4 border text-center">Baki (‡§¨‡§æ‡§ï‡•Ä)</th>
              <th class="p-4 border text-center">Action</th>
            </tr>
          </thead>
          <tbody class="text-sm">`;
      
      data.forEach(row => {
        const isDef = Number(row.Balance) > 0;
        html += `
          <tr class="border-b hover:bg-gray-50 transition">
            <td class="p-4 font-bold text-gray-500 border">${row.StudentID}</td>
            <td class="p-4 border">
                <div class="font-black text-blue-900 uppercase">${row.Name}</div>
                <div class="text-[10px] text-gray-400 font-bold italic">${row.Class}</div>
            </td>
            <td class="p-4 border text-center">
              <span class="${isDef ? 'bg-red-100 text-red-600' : 'bg-green-100 text-green-600'} px-4 py-1.5 rounded-full font-black text-xs shadow-inner">
                ‚Çπ${row.Balance}
              </span>
            </td>
            <td class="p-4 border text-center">
              <button onclick="payFees('${row.StudentID}')" class="bg-blue-600 hover:bg-black text-white px-5 py-2 rounded-xl text-[10px] font-black shadow-lg transition transform active:scale-95">
                FEES UPDATE
              </button>
            </td>
          </tr>`;
      });
      
      html += `</tbody></table>`;
      area.innerHTML = data.length > 0 ? html : "<p class='p-20 text-center text-gray-400 font-black uppercase italic'>No Records Found!</p>";
    }

    async function payFees(id) {
      let amt = prompt(`ID: ${id} ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ú‡§Æ‡§æ ‡§∞‡§æ‡§∂‡§ø ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç (‚Çπ):`);
      if(!amt || isNaN(amt)) return;
      
      const resp = await fetch(SCRIPT_URL, {method:'POST', body: JSON.stringify({action:"updateFees", id:id, amount:amt})});
      const result = await resp.json();
      if(result.success) {
        alert("‡§´‡•Ä‡§∏ ‡§∏‡§´‡§≤‡§§‡§æ‡§™‡•Ç‡§∞‡•ç‡§µ‡§ï ‡§Ö‡§™‡§°‡•á‡§ü ‡§π‡•ã ‡§ó‡§Ø‡•Ä!");
        loadAdminData();
      } else {
        alert("Error updating fees!");
      }
    }
  </script>
</body>
</html>
